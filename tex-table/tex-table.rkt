#lang racket/base
(require racket/contract racket/match)

(define (string-len-one? x)
  (and (string? x)
       (= 1 (string-length x))))
  
(provide/contract
 [tex-shortcut-table
  (listof (list/c string? string-len-one?))])

(define blackboard-bold
  (append
   (for*/list ([i (in-string "ABCDEFGHIJKLMNOPQRSTUVWXYZ")]
               [case (in-list '(lower upper))])
     (cond
       [(and (equal? case 'upper) (member i (string->list "CHNPQRZ")))
        (list (format "b~a" i)
              (match i
                [#\C "â„‚"]
                [#\H "â„"]
                [#\N "â„•"]
                [#\P "â„™"]
                [#\Q "â„š"]
                [#\R "â„"]
                [#\Z "â„¤"]))]
       [else
        (define bo (match case
                     ['upper (- (char->integer #\ð”¸) (char->integer #\A))]
                     ['lower (- (char->integer #\ð•’) (char->integer #\A))]))
        (define co (match case
                     ['upper 0]
                     ['lower (- (char->integer #\a) (char->integer #\A))]))
        (list (format "b~a" (integer->char (+ (char->integer i) co)))
              (string (integer->char (+ (char->integer i) bo))))]))
   (for/list ([i (in-inclusive-range 0 9)])
     (list (format "b~a" i)
           (string (integer->char (+ (char->integer #\ðŸ˜) i)))))))

(define tex-shortcut-table
  (append
  '(("Downarrow" "â‡“")
    ("nwarrow" "â†–")
    ("downarrow" "â†“")
    ("Rightarrow" "â‡’")
    ("rightarrow" "â†’")
    ("rightharpoonup" "â‡€")
    ("leftharpoonup" "â†¼")
    ("rightharpoondown" "â‡")
    ("leftharpoondown" "â†½")
    ("rightleftharpoons" "â‡Œ")
    ("mapsto" "â†¦")
    ("searrow" "â†˜")
    ("swarrow" "â†™")
    ("leftarrow" "â†")
    ("uparrow" "â†‘")
    ("Leftarrow" "â‡")
    ("longrightarrow" "âŸ¶")
    ("Uparrow" "â‡‘")
    ("Leftrightarrow" "â‡”")
    ("updownarrow" "â†•")
    ("leftrightarrow" "â†”")
    ("nearrow" "â†—")
    ("Updownarrow" "â‡•")
    ("leadsto" "â†")
   
    ;; arrows that didn't come out right in copy & paste
    ;â†âˆ’ \longleftarrow
    ;â‡= \Longleftarrow 
    ;â† ô°‚ \hookleftarrow
    ;â†â†’ \longleftrightarrow 
    ;ô° â†’ \hookrightarrow
    ;â‡â‡’ \Longleftrightarrow
    ;ô´² \leadstoâˆ— 
    ;ô°ƒâˆ’â†’ \longmapsto
    ;=â‡’ \Longrightarrow 
    ;ô°ƒâ†’ \mapsto
    
    ("aleph" "×")
    ("prime" "â€²")
    ("emptyset" "âˆ…")
    ("nabla" "âˆ‡")
    ("diamondsuit" "â™¦")
    ("spadesuit" "â™ ")
    ("clubsuit" "â™£")
    ("heartsuit" "â™¥")
    ("sharp" "â™¯")
    ("flat" "â™­")
    ("natural" "â™®")
    ("surd" "âˆš")
    ("neg" "Â¬")
    ("triangle" "â–³")
    ("forall" "âˆ€")
    ("all" "âˆ€")
    ("exists" "âˆƒ")
    ("infty" "âˆž")
    ("circ" "âˆ˜")
    ("partial" "âˆ‚")
    ("alpha" "Î±")
    ("theta" "Î¸")
    ("tau" "Ï„")
    ("beta" "Î²")
    ("vartheta" "Ï‘")
    ("pi" "Ï€")
    ("upsilon" "Ï…")
    ("gamma" "Î³")
    ("varpi" "Ï–")
    ("phi" "Ï•")
    ("delta" "Î´")
    ("kappa" "Îº")
    ("rho" "Ï")
    ("varphi" "Ï†")
    ("epsilon" "Ïµ")
    ("lambda" "Î»")
    ("varrho" "Ï±")
    ("chi" "Ï‡")
    ("varepsilon" "Îµ")
    ("mu" "Î¼")
    ("sigma" "Ïƒ")
    ("psi" "Ïˆ")
    ("zeta" "Î¶")
    ("nu" "Î½")
    ("varsigma" "Ï‚")
    ("omega" "Ï‰")
    ("eta" "Î·")
    ("xi" "Î¾")
    ("iota" "Î¹")
    ("Gamma" "Î“")
    ("Lambda" "Î›")
    ("Sigma" "Î£")
    ("Psi" "Î¨")
    ("Delta" "Î”")
    ("Xi" "Îž")
    ("Upsilon" "Î¥")
    ("Omega" "Î©")
    ("Theta" "Î˜")
    ("Pi" "Î ")
    ("Phi" "Î¦")
    ("pm" "Â±")
    ("cap" "âˆ©")
    ("diamond" "â—‡")
    ("lozenge" "â—Š")
    ("square" "â–¡")
    ("oplus" "âŠ•")
    ("mp" "âˆ“")
    ("cup" "âˆª")
    ("bigtriangleup" "â–³")
    ("ominus" "âŠ–")
    ("times" "Ã—")
    ("uplus" "âŠŽ")
    ("bigtriangledown" "â–½")
    ("otimes" "âŠ—")
    ("div" "Ã·")
    ("sqcap" "âŠ“")
    ("triangleright" "â–¹")
    ("oslash" "âŠ˜")
    ("ast" "âˆ—")
    ("sqcup" "âŠ”")
    ("vee" "âˆ¨")
    ("wedge" "âˆ§")
    ("lor" "âˆ¨")
    ("land" "âˆ§")
    ("lnot" "Â¬")
    ("triangleleft" "â—ƒ")
    ("angle" "âˆ ")
    ("odot" "âŠ™")
    ("star" "â˜…")
    ("dagger" "â€ ")
    ("bullet" "â€¢")
    ("ddagger" "â€¡")
    ("wr" "â‰€")
    ("amalg" "â¨¿")
    ("leq" "â‰¤")
    ("geq" "â‰¥")
    ("equiv" "â‰¡")
    ("models" "âŠ¨")
    ("prec" "â‰º")
    ("succ" "â‰»")
    ("precdot" "â‹–")
    ("succdot" "â‹—")
    ("sim" "âˆ¼")
    ("perp" "âŠ¥")
    ("bot" "âŠ¥")
    ("top" "âŠ¤")
    ("preceq" "â‰¼")
    ("succeq" "â‰½")
    ("simeq" "â‰ƒ")
    ("ll" "â‰ª")
    ("gg" "â‰«")
    ("guillemetleft" "Â«")
    ("guillemetright" "Â»")
    ("asymp" "â‰")
    ("parallel" "âˆ¥")
    ("subset" "âŠ‚")
    ("supset" "âŠƒ")
    ("approx" "â‰ˆ")
    ("bowtie" "â‹ˆ")
    ("subseteq" "âŠ†")
    ("supseteq" "âŠ‡")
    ("nsubseteq" "âŠˆ")
    ("subsetneq" "âŠŠ")
    ("cong" "â‰…")
    ("sqsubsetb" "âŠ")
    ("sqsupsetb" "âŠ")
    ("neq" #;"â‰ " "â‰ ")
    ("smile" "âŒ£")
    ("sqsubseteq" "âŠ‘")
    ("sqsupseteq" "âŠ’")
    ("doteq" "â‰")
    ("frown" "âŒ¢")
    ("in" "âˆˆ")
    ("ni" "âˆ‹")
    ("notin" "âˆ‰")
    ("propto" "âˆ")
    ("vdash" "âŠ¢")
    ("dashv" "âŠ£")
    ("cdot" "Â·")
    ("sum" "âˆ‘")
    ("prod" "âˆ")
    ("coprod" "âˆ")
    
    ("int" "âˆ«")
    ("iint" "âˆ¬")
    ("iiint" "âˆ­")
    ("oint" "âˆ®")
    ("oiint" "âˆ¯")
    ("oiiint" "âˆ°")

    ("sqrt" "âˆš")
    
    ("skull" "â˜ ") 
    ("smiley" "â˜º")
    ("blacksmiley" "â˜»")
    ("frownie" "â˜¹")

    ("Re" "â„œ")
    ("Im" "â„‘")
    ("S" "Â§")
    ("l" "Å‚")

    ("newpage" "\f")
    
    ("vdots" "â‹®")
    ("ddots" "â‹±")
    ("cdots" "â‹¯")
    ("hdots" "â‹¯")
    ("ldots" "â€¦")
    
    ("langle" "âŸ¨")
    ("rangle" "âŸ©")

    ("amp" "&")
    ("invamp" "â…‹")

    ("multimap" "âŠ¸")
    ("rightlollipop" "âŠ¸")
    ("leftmultimap" "âŸœ")
    ("multimapinv" "âŸœ")
    ("leftlollipop" "âŸœ")
    )
  blackboard-bold))

(module+ test
  (define name-ht (make-hash))
  (define val-ht (make-hash))
  (for ([line (in-list tex-shortcut-table)])
    (match-define (list name obj) line)
    (hash-set! name-ht name (cons obj (hash-ref name-ht name '()))))
  (for ([(k v) (in-hash name-ht)])
    (unless (= 1 (length v))
      (eprintf "duplicate: ~s -> ~s\n" k v))))


